<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: ApplicationInventaire.Core.ExcelManagement.ExcelFile Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_application_inventaire.html">ApplicationInventaire</a></li><li class="navelem"><a class="el" href="namespace_application_inventaire_1_1_core.html">Core</a></li><li class="navelem"><a class="el" href="namespace_application_inventaire_1_1_core_1_1_excel_management.html">ExcelManagement</a></li><li class="navelem"><a class="el" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file.html">ExcelFile</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#properties">Properties</a> &#124;
<a href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">ApplicationInventaire.Core.ExcelManagement.ExcelFile Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Class to operate on an excel file. INDEXES START AT ZERO.  
 <a href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a066f074583024ae5525e73b22981a07d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file.html#a066f074583024ae5525e73b22981a07d">ExcelFile</a> (string filename)</td></tr>
<tr class="separator:a066f074583024ae5525e73b22981a07d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24e4069458ce7ca2d5cf6ca16b7aded3"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file.html#a24e4069458ce7ca2d5cf6ca16b7aded3">GetCellValue</a> (string sheetName, int row, int column)</td></tr>
<tr class="memdesc:a24e4069458ce7ca2d5cf6ca16b7aded3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to return the string contained in the cell in a given row column and sheet.  <br /></td></tr>
<tr class="separator:a24e4069458ce7ca2d5cf6ca16b7aded3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06324a582dfd58e56cfca3f41f981a09"><td class="memItemLeft" align="right" valign="top">byte[]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file.html#a06324a582dfd58e56cfca3f41f981a09">GetCellColor</a> (string sheetName, int row, int column)</td></tr>
<tr class="memdesc:a06324a582dfd58e56cfca3f41f981a09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the color of a given cell presents on a given sheet, at a given row and column.  <br /></td></tr>
<tr class="separator:a06324a582dfd58e56cfca3f41f981a09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35362ac6effb32a3e6f2038325945464"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file.html#a35362ac6effb32a3e6f2038325945464">SetCellValue</a> (string sheetName, string content, int column, int row)</td></tr>
<tr class="memdesc:a35362ac6effb32a3e6f2038325945464"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the cell in a given row column and sheet to a given string  <br /></td></tr>
<tr class="separator:a35362ac6effb32a3e6f2038325945464"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aace1a5a981ebc09c8e0721d9c5ba257c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file.html#aace1a5a981ebc09c8e0721d9c5ba257c">UpdateSignature</a> ()</td></tr>
<tr class="memdesc:aace1a5a981ebc09c8e0721d9c5ba257c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is called when the user click "enregistrer et quitter" in the inventory update. It will add the current date end the user name (name of the session) at the end of the document in the two colums "DATE de MISE A JOUR" and "NOM + SIGNATURE".  <br /></td></tr>
<tr class="separator:aace1a5a981ebc09c8e0721d9c5ba257c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a863dcac459cb2729890ee5c3af1fad78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file.html#a863dcac459cb2729890ee5c3af1fad78">UpdateExcelFormula</a> ()</td></tr>
<tr class="memdesc:a863dcac459cb2729890ee5c3af1fad78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Go through all excel file and update the cell according to their value. This is used because just changing the value with the function SetCellValue doesn't do anything.  <br /></td></tr>
<tr class="separator:a863dcac459cb2729890ee5c3af1fad78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae08e9d32876e7f3fadf0768888efdb3b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_cell_info.html">CellInfo</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file.html#ae08e9d32876e7f3fadf0768888efdb3b">FindValue</a> (string content)</td></tr>
<tr class="memdesc:ae08e9d32876e7f3fadf0768888efdb3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">find the first cell in a given file (.xls or .xlsx) containing a given string  <br /></td></tr>
<tr class="separator:ae08e9d32876e7f3fadf0768888efdb3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a835b2b01c906407885f05e306a9ba67e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file.html#a835b2b01c906407885f05e306a9ba67e">DispDataExcel</a> ()</td></tr>
<tr class="separator:a835b2b01c906407885f05e306a9ba67e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="properties" name="properties"></a>
Properties</h2></td></tr>
<tr class="memitem:a7a503282c1e70c3c0c830735eb878d93"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file.html#a7a503282c1e70c3c0c830735eb878d93">FilePath</a><code> [get, set]</code></td></tr>
<tr class="separator:a7a503282c1e70c3c0c830735eb878d93"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class to operate on an excel file. INDEXES START AT ZERO. </p>

<p class="definition">Definition at line <a class="el" href="_excel_management_8cs_source.html#l00057">57</a> of file <a class="el" href="_excel_management_8cs_source.html">ExcelManagement.cs</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a066f074583024ae5525e73b22981a07d" name="a066f074583024ae5525e73b22981a07d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a066f074583024ae5525e73b22981a07d">&#9670;&#160;</a></span>ExcelFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ApplicationInventaire.Core.ExcelManagement.ExcelFile.ExcelFile </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_excel_management_8cs_source.html#l00066">66</a> of file <a class="el" href="_excel_management_8cs_source.html">ExcelManagement.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   67</span>        {</div>
<div class="line"><span class="lineno">   68</span>            FilePath = filename;</div>
<div class="line"><span class="lineno">   69</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a835b2b01c906407885f05e306a9ba67e" name="a835b2b01c906407885f05e306a9ba67e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a835b2b01c906407885f05e306a9ba67e">&#9670;&#160;</a></span>DispDataExcel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ApplicationInventaire.Core.ExcelManagement.ExcelFile.DispDataExcel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_excel_management_8cs_source.html#l00544">544</a> of file <a class="el" href="_excel_management_8cs_source.html">ExcelManagement.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  545</span>        {</div>
<div class="line"><span class="lineno">  546</span>            Console.WriteLine(<span class="stringliteral">&quot; Excel FilePath: &quot;</span> + FilePath);</div>
<div class="line"><span class="lineno">  547</span> </div>
<div class="line"><span class="lineno">  548</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae08e9d32876e7f3fadf0768888efdb3b" name="ae08e9d32876e7f3fadf0768888efdb3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae08e9d32876e7f3fadf0768888efdb3b">&#9670;&#160;</a></span>FindValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_cell_info.html">CellInfo</a> ApplicationInventaire.Core.ExcelManagement.ExcelFile.FindValue </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>content</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find the first cell in a given file (.xls or .xlsx) containing a given string </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">content</td><td>the string that must be found </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the method return a CellInfo struct {int row, int colums, int sheetNumber} . if nothing is found the struct returned has the sheet field set to -1</dd></dl>
<p><br  />
 </p>

<p class="definition">Definition at line <a class="el" href="_excel_management_8cs_source.html#l00434">434</a> of file <a class="el" href="_excel_management_8cs_source.html">ExcelManagement.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  435</span>        {</div>
<div class="line"><span class="lineno">  436</span>            <a class="code hl_class" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_cell_info.html">CellInfo</a> cellInfo = <span class="keyword">new</span> <a class="code hl_class" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_cell_info.html">CellInfo</a>();</div>
<div class="line"><span class="lineno">  437</span>            <span class="keywordflow">if</span> (FilePath.IndexOf(<span class="stringliteral">&quot;.xlsx&quot;</span>) &gt; 0)</div>
<div class="line"><span class="lineno">  438</span>            {</div>
<div class="line"><span class="lineno">  439</span>                <span class="keyword">using</span> (var file = <span class="keyword">new</span> FileStream(FilePath, FileMode.Open, FileAccess.Read))</div>
<div class="line"><span class="lineno">  440</span>                {</div>
<div class="line"><span class="lineno">  441</span>                    XSSFWorkbook workbook = <span class="keyword">new</span> XSSFWorkbook(file);</div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>                    <span class="comment">// Loop through each sheet in the workbook</span></div>
<div class="line"><span class="lineno">  444</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> sheetIndex = 0; sheetIndex &lt; workbook.NumberOfSheets; sheetIndex++)</div>
<div class="line"><span class="lineno">  445</span>                    {</div>
<div class="line"><span class="lineno">  446</span>                        ISheet sheet = workbook.GetSheetAt(sheetIndex);</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span>                        <span class="comment">// Loop through each row in the sheet</span></div>
<div class="line"><span class="lineno">  449</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rowIndex = 0; rowIndex &lt;= sheet.LastRowNum; rowIndex++)</div>
<div class="line"><span class="lineno">  450</span>                        {</div>
<div class="line"><span class="lineno">  451</span>                            IRow row = sheet.GetRow(rowIndex);</div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span>                            <span class="comment">// Loop through each cell in the row</span></div>
<div class="line"><span class="lineno">  454</span>                            <span class="keywordflow">if</span> (row != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  455</span>                            {</div>
<div class="line"><span class="lineno">  456</span>                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> columnIndex = 0; columnIndex &lt; row.LastCellNum; columnIndex++)</div>
<div class="line"><span class="lineno">  457</span>                                {</div>
<div class="line"><span class="lineno">  458</span>                                    ICell cell = row.GetCell(columnIndex);</div>
<div class="line"><span class="lineno">  459</span> </div>
<div class="line"><span class="lineno">  460</span>                                    <span class="keywordflow">if</span> (cell != <span class="keyword">null</span> &amp;&amp; cell.CellType == CellType.String &amp;&amp; cell.StringCellValue.Equals(content))</div>
<div class="line"><span class="lineno">  461</span>                                    {</div>
<div class="line"><span class="lineno">  462</span>                                        <span class="comment">// Cell with matching content found, populate the CellInfo struct</span></div>
<div class="line"><span class="lineno">  463</span>                                        cellInfo.Row = rowIndex;</div>
<div class="line"><span class="lineno">  464</span>                                        cellInfo.Column = columnIndex;</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>                                        cellInfo.Sheet = sheet.SheetName;</div>
<div class="line"><span class="lineno">  467</span>                                 </div>
<div class="line"><span class="lineno">  468</span>                                        <span class="keywordflow">return</span> cellInfo;</div>
<div class="line"><span class="lineno">  469</span>                                    }</div>
<div class="line"><span class="lineno">  470</span>                                }</div>
<div class="line"><span class="lineno">  471</span>                            }</div>
<div class="line"><span class="lineno">  472</span>                        }</div>
<div class="line"><span class="lineno">  473</span>                        </div>
<div class="line"><span class="lineno">  474</span>                    }</div>
<div class="line"><span class="lineno">  475</span>                    file.Close();</div>
<div class="line"><span class="lineno">  476</span>                }</div>
<div class="line"><span class="lineno">  477</span>            }</div>
<div class="line"><span class="lineno">  478</span> </div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FilePath.IndexOf(<span class="stringliteral">&quot;.xls&quot;</span>) &gt; 0)</div>
<div class="line"><span class="lineno">  482</span>            {</div>
<div class="line"><span class="lineno">  483</span> </div>
<div class="line"><span class="lineno">  484</span> </div>
<div class="line"><span class="lineno">  485</span>                <span class="keyword">using</span> (var file = <span class="keyword">new</span> FileStream(FilePath, FileMode.Open, FileAccess.Read))</div>
<div class="line"><span class="lineno">  486</span>                {</div>
<div class="line"><span class="lineno">  487</span>                    HSSFWorkbook workbook;</div>
<div class="line"><span class="lineno">  488</span>                    <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno">  489</span>                    {</div>
<div class="line"><span class="lineno">  490</span>                        workbook = <span class="keyword">new</span> HSSFWorkbook(file);</div>
<div class="line"><span class="lineno">  491</span>                    }</div>
<div class="line"><span class="lineno">  492</span>                    <span class="keywordflow">catch</span>(Exception e) <span class="comment">//problem with file format, abort da mission</span></div>
<div class="line"><span class="lineno">  493</span>                    {</div>
<div class="line"><span class="lineno">  494</span>                        <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  495</span>                    } </div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span> </div>
<div class="line"><span class="lineno">  498</span>                    <span class="comment">// Loop through each sheet in the workbook</span></div>
<div class="line"><span class="lineno">  499</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> sheetIndex = 0; sheetIndex &lt; workbook.NumberOfSheets; sheetIndex++)</div>
<div class="line"><span class="lineno">  500</span>                    {</div>
<div class="line"><span class="lineno">  501</span>                        ISheet sheet = workbook.GetSheetAt(sheetIndex);</div>
<div class="line"><span class="lineno">  502</span> </div>
<div class="line"><span class="lineno">  503</span>                        <span class="comment">// Loop through each row in the sheet</span></div>
<div class="line"><span class="lineno">  504</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rowIndex = 0; rowIndex &lt;= sheet.LastRowNum; rowIndex++)</div>
<div class="line"><span class="lineno">  505</span>                        {</div>
<div class="line"><span class="lineno">  506</span>                            IRow row = sheet.GetRow(rowIndex);</div>
<div class="line"><span class="lineno">  507</span> </div>
<div class="line"><span class="lineno">  508</span>                            <span class="comment">// Loop through each cell in the row</span></div>
<div class="line"><span class="lineno">  509</span>                            <span class="keywordflow">if</span> (row != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  510</span>                            {</div>
<div class="line"><span class="lineno">  511</span>                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> columnIndex = 0; columnIndex &lt; row.LastCellNum; columnIndex++)</div>
<div class="line"><span class="lineno">  512</span>                                {</div>
<div class="line"><span class="lineno">  513</span>                                    ICell cell = row.GetCell(columnIndex);</div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>                                    <span class="keywordflow">if</span> (cell != <span class="keyword">null</span> &amp;&amp; cell.CellType == CellType.String &amp;&amp; cell.StringCellValue == content)</div>
<div class="line"><span class="lineno">  516</span>                                    {</div>
<div class="line"><span class="lineno">  517</span>                                        <span class="comment">// Cell with matching content found, populate the CellInfo struct</span></div>
<div class="line"><span class="lineno">  518</span>                                        cellInfo.Row = rowIndex;</div>
<div class="line"><span class="lineno">  519</span>                                        cellInfo.Column = columnIndex;</div>
<div class="line"><span class="lineno">  520</span>                                        cellInfo.Sheet = sheet.SheetName;</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>                                    </div>
<div class="line"><span class="lineno">  523</span>                                        <span class="keywordflow">return</span> cellInfo;</div>
<div class="line"><span class="lineno">  524</span>                                    }</div>
<div class="line"><span class="lineno">  525</span>                                }</div>
<div class="line"><span class="lineno">  526</span>                            }</div>
<div class="line"><span class="lineno">  527</span>                        }</div>
<div class="line"><span class="lineno">  528</span>                    }</div>
<div class="line"><span class="lineno">  529</span>                    file.Close();</div>
<div class="line"><span class="lineno">  530</span>                }</div>
<div class="line"><span class="lineno">  531</span> </div>
<div class="line"><span class="lineno">  532</span>            }</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>            <span class="comment">// Cell with matching content not found</span></div>
<div class="line"><span class="lineno">  537</span>            cellInfo.Sheet = <span class="keyword">null</span>; <span class="comment">// return -1 for sheet by default if nothing is found</span></div>
<div class="line"><span class="lineno">  538</span>            <span class="keywordflow">return</span> cellInfo;</div>
<div class="line"><span class="lineno">  539</span>        }</div>
<div class="ttc" id="aclass_application_inventaire_1_1_core_1_1_excel_management_1_1_cell_info_html"><div class="ttname"><a href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_cell_info.html">ApplicationInventaire.Core.ExcelManagement.CellInfo</a></div><div class="ttdoc">Used to store information about an excel cell.</div><div class="ttdef"><b>Definition</b> <a href="_excel_management_8cs_source.html#l00030">ExcelManagement.cs:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a06324a582dfd58e56cfca3f41f981a09" name="a06324a582dfd58e56cfca3f41f981a09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06324a582dfd58e56cfca3f41f981a09">&#9670;&#160;</a></span>GetCellColor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">byte[] ApplicationInventaire.Core.ExcelManagement.ExcelFile.GetCellColor </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>sheetName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>column</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the color of a given cell presents on a given sheet, at a given row and column. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sheetName</td><td></td></tr>
    <tr><td class="paramname">row</td><td></td></tr>
    <tr><td class="paramname">column</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>byte[3] array, containing RGB values</dd></dl>

<p class="definition">Definition at line <a class="el" href="_excel_management_8cs_source.html#l00141">141</a> of file <a class="el" href="_excel_management_8cs_source.html">ExcelManagement.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  142</span>        {</div>
<div class="line"><span class="lineno">  143</span>            <span class="keywordtype">string</span> cellValue = <span class="keywordtype">string</span>.Empty;</div>
<div class="line"><span class="lineno">  144</span>            <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno">  145</span>            {</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>                <span class="keywordflow">if</span> (FilePath.IndexOf(<span class="stringliteral">&quot;.xlsx&quot;</span>) &gt; 0)</div>
<div class="line"><span class="lineno">  148</span>                {</div>
<div class="line"><span class="lineno">  149</span>                    <span class="keyword">using</span> (var file = <span class="keyword">new</span> FileStream(FilePath, FileMode.Open, FileAccess.Read))</div>
<div class="line"><span class="lineno">  150</span>                    {</div>
<div class="line"><span class="lineno">  151</span>                        XSSFWorkbook workbook = <span class="keyword">new</span> XSSFWorkbook(file);</div>
<div class="line"><span class="lineno">  152</span>                        ISheet sheet = workbook.GetSheet(sheetName);</div>
<div class="line"><span class="lineno">  153</span>                        IRow excelRow = sheet.GetRow(row);</div>
<div class="line"><span class="lineno">  154</span>                        ICell cell = excelRow.GetCell(column);</div>
<div class="line"><span class="lineno">  155</span>                        <span class="keywordflow">if</span> (cell != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  156</span>                        {</div>
<div class="line"><span class="lineno">  157</span>                            ICellStyle cellStyle = cell.CellStyle;</div>
<div class="line"><span class="lineno">  158</span>                            XSSFColor color = cell.CellStyle.FillForegroundColorColor as XSSFColor;</div>
<div class="line"><span class="lineno">  159</span>                            <span class="keywordtype">byte</span>[] rgb = color.RGB;</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>                            <span class="keywordflow">return</span> rgb;</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>                        }</div>
<div class="line"><span class="lineno">  165</span>                        file.Close();</div>
<div class="line"><span class="lineno">  166</span>                    }</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span>                }</div>
<div class="line"><span class="lineno">  170</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FilePath.IndexOf(<span class="stringliteral">&quot;.xls&quot;</span>) &gt; 0)</div>
<div class="line"><span class="lineno">  171</span>                {</div>
<div class="line"><span class="lineno">  172</span>                    <span class="keyword">using</span> (var file = <span class="keyword">new</span> FileStream(FilePath, FileMode.Open, FileAccess.Read))</div>
<div class="line"><span class="lineno">  173</span>                    {</div>
<div class="line"><span class="lineno">  174</span>                        HSSFWorkbook workbook = <span class="keyword">new</span> HSSFWorkbook(file);</div>
<div class="line"><span class="lineno">  175</span>                        ISheet sheet = workbook.GetSheet(sheetName);</div>
<div class="line"><span class="lineno">  176</span>                        IRow excelRow = sheet.GetRow(row);</div>
<div class="line"><span class="lineno">  177</span>                        ICell cell = excelRow.GetCell(column);</div>
<div class="line"><span class="lineno">  178</span>                        <span class="keywordflow">if</span> (cell != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  179</span>                        {</div>
<div class="line"><span class="lineno">  180</span>                            ICellStyle cellStyle = cell.CellStyle;</div>
<div class="line"><span class="lineno">  181</span>                            IFont font = cellStyle.GetFont(workbook);</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>                            HSSFColor color = cell.CellStyle.FillForegroundColorColor as HSSFColor;</div>
<div class="line"><span class="lineno">  185</span>                            <span class="keywordtype">byte</span>[] rgb = color.RGB;</div>
<div class="line"><span class="lineno">  186</span>                            <span class="keywordflow">return</span> rgb;</div>
<div class="line"><span class="lineno">  187</span>                        }</div>
<div class="line"><span class="lineno">  188</span>                        file.Close();</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>                    }</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>                }</div>
<div class="line"><span class="lineno">  194</span> </div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>            }</div>
<div class="line"><span class="lineno">  198</span>            <span class="keywordflow">catch</span> (IOException ex)</div>
<div class="line"><span class="lineno">  199</span>            {</div>
<div class="line"><span class="lineno">  200</span>                <span class="comment">// Handle file-related errors</span></div>
<div class="line"><span class="lineno">  201</span>                Console.WriteLine(<span class="stringliteral">&quot;Une erreur s&#39;est produite lors de la lecture du fichier Excel: &quot;</span> + ex.Message);</div>
<div class="line"><span class="lineno">  202</span>            }</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>            <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  205</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a24e4069458ce7ca2d5cf6ca16b7aded3" name="a24e4069458ce7ca2d5cf6ca16b7aded3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24e4069458ce7ca2d5cf6ca16b7aded3">&#9670;&#160;</a></span>GetCellValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string ApplicationInventaire.Core.ExcelManagement.ExcelFile.GetCellValue </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>sheetName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>column</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used to return the string contained in the cell in a given row column and sheet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sheetName</td><td>name of the sheet targeted</td></tr>
    <tr><td class="paramname">row</td><td></td></tr>
    <tr><td class="paramname">column</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the content of the cell converted to string</dd></dl>

<p class="definition">Definition at line <a class="el" href="_excel_management_8cs_source.html#l00080">80</a> of file <a class="el" href="_excel_management_8cs_source.html">ExcelManagement.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   81</span>        {</div>
<div class="line"><span class="lineno">   82</span>            <span class="keywordtype">string</span> cellValue = <span class="keywordtype">string</span>.Empty;</div>
<div class="line"><span class="lineno">   83</span>            <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno">   84</span>            {</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>                <span class="keywordflow">if</span> (FilePath.IndexOf(<span class="stringliteral">&quot;.xlsx&quot;</span>) &gt; 0)</div>
<div class="line"><span class="lineno">   87</span>                {</div>
<div class="line"><span class="lineno">   88</span>                    <span class="keyword">using</span> (var file = <span class="keyword">new</span> FileStream(FilePath, FileMode.Open, FileAccess.Read))</div>
<div class="line"><span class="lineno">   89</span>                    {</div>
<div class="line"><span class="lineno">   90</span>                        XSSFWorkbook workbook = <span class="keyword">new</span> XSSFWorkbook(file);</div>
<div class="line"><span class="lineno">   91</span>                        ISheet sheet = workbook.GetSheet(sheetName);</div>
<div class="line"><span class="lineno">   92</span>                        IRow excelRow = sheet.GetRow(row);</div>
<div class="line"><span class="lineno">   93</span>                        ICell cell = excelRow.GetCell(column);</div>
<div class="line"><span class="lineno">   94</span>                        <span class="keywordflow">if</span> (cell != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">   95</span>                        {</div>
<div class="line"><span class="lineno">   96</span>                            cellValue = cell.ToString();</div>
<div class="line"><span class="lineno">   97</span>                        }</div>
<div class="line"><span class="lineno">   98</span>                        file.Close();</div>
<div class="line"><span class="lineno">   99</span>                    }</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>                }</div>
<div class="line"><span class="lineno">  103</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FilePath.IndexOf(<span class="stringliteral">&quot;.xls&quot;</span>) &gt; 0)</div>
<div class="line"><span class="lineno">  104</span>                {</div>
<div class="line"><span class="lineno">  105</span>                    <span class="keyword">using</span> (var file = <span class="keyword">new</span> FileStream(FilePath, FileMode.Open, FileAccess.Read))</div>
<div class="line"><span class="lineno">  106</span>                    {</div>
<div class="line"><span class="lineno">  107</span>                        HSSFWorkbook workbook = <span class="keyword">new</span> HSSFWorkbook(file);</div>
<div class="line"><span class="lineno">  108</span>                        ISheet sheet = workbook.GetSheet(sheetName);</div>
<div class="line"><span class="lineno">  109</span>                        IRow excelRow = sheet.GetRow(row);</div>
<div class="line"><span class="lineno">  110</span>                        ICell cell = excelRow.GetCell(column);</div>
<div class="line"><span class="lineno">  111</span>                        <span class="keywordflow">if</span> (cell != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  112</span>                        {</div>
<div class="line"><span class="lineno">  113</span>                            cellValue = cell.ToString();</div>
<div class="line"><span class="lineno">  114</span>                        }</div>
<div class="line"><span class="lineno">  115</span>                        file.Close();</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>                    }</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span>                }</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>            }</div>
<div class="line"><span class="lineno">  125</span>            <span class="keywordflow">catch</span> (IOException ex)</div>
<div class="line"><span class="lineno">  126</span>            {</div>
<div class="line"><span class="lineno">  127</span>                <span class="comment">// Handle file-related errors</span></div>
<div class="line"><span class="lineno">  128</span>                Console.WriteLine(<span class="stringliteral">&quot;Une erreur s&#39;est produite lors de la lecture du fichier Excel: &quot;</span> + ex.Message);</div>
<div class="line"><span class="lineno">  129</span>            }</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>            <span class="keywordflow">return</span> cellValue;</div>
<div class="line"><span class="lineno">  132</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a35362ac6effb32a3e6f2038325945464" name="a35362ac6effb32a3e6f2038325945464"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35362ac6effb32a3e6f2038325945464">&#9670;&#160;</a></span>SetCellValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ApplicationInventaire.Core.ExcelManagement.ExcelFile.SetCellValue </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>sheetName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>content</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>column</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>row</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set the cell in a given row column and sheet to a given string </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sheetName</td><td>name of the targeted sheet</td></tr>
    <tr><td class="paramname">content</td><td>string which will be put in the cell</td></tr>
    <tr><td class="paramname">row</td><td></td></tr>
    <tr><td class="paramname">column</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_excel_management_8cs_source.html#l00214">214</a> of file <a class="el" href="_excel_management_8cs_source.html">ExcelManagement.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  215</span>        {</div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>            <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno">  218</span>            {</div>
<div class="line"><span class="lineno">  219</span>                <span class="keywordflow">if</span> (FilePath.IndexOf(<span class="stringliteral">&quot;.xlsx&quot;</span>) &gt; 0)</div>
<div class="line"><span class="lineno">  220</span>                {</div>
<div class="line"><span class="lineno">  221</span>                    <span class="keyword">using</span> (var file = <span class="keyword">new</span> FileStream(FilePath, FileMode.Open, FileAccess.Read))</div>
<div class="line"><span class="lineno">  222</span>                    {</div>
<div class="line"><span class="lineno">  223</span>                        XSSFWorkbook workbook = <span class="keyword">new</span> XSSFWorkbook(file);</div>
<div class="line"><span class="lineno">  224</span>                        ISheet sheet = workbook.GetSheet(sheetName);</div>
<div class="line"><span class="lineno">  225</span>                        IRow excelRow = sheet.GetRow(row);</div>
<div class="line"><span class="lineno">  226</span>                        <span class="keywordflow">if</span>(excelRow==<span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  227</span>                        {</div>
<div class="line"><span class="lineno">  228</span>                            excelRow = sheet.CreateRow(row);</div>
<div class="line"><span class="lineno">  229</span>                        }</div>
<div class="line"><span class="lineno">  230</span>                        ICell cell = excelRow.GetCell(column) ?? excelRow.CreateCell(column);</div>
<div class="line"><span class="lineno">  231</span>                        <span class="keywordflow">if</span>(content.Equals(<span class="stringliteral">&quot;1&quot;</span>))</div>
<div class="line"><span class="lineno">  232</span>                        {</div>
<div class="line"><span class="lineno">  233</span>                            cell.SetCellValue(1);</div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>                        }</div>
<div class="line"><span class="lineno">  236</span>                       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (content.Equals(<span class="stringliteral">&quot;0&quot;</span>))</div>
<div class="line"><span class="lineno">  237</span>                        {</div>
<div class="line"><span class="lineno">  238</span>                            cell.SetCellValue(0);</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>                        }</div>
<div class="line"><span class="lineno">  241</span>                        <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno">  242</span>                        {</div>
<div class="line"><span class="lineno">  243</span>                            cell.SetCellValue(content); <span class="comment">//there is no recurence, fonction from NPOI library</span></div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>                        }</div>
<div class="line"><span class="lineno">  247</span>                        var formulaEvaluator = workbook.GetCreationHelper().CreateFormulaEvaluator();</div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span>                        <span class="comment">// Evaluate the formulas</span></div>
<div class="line"><span class="lineno">  250</span>                        formulaEvaluator.EvaluateAll();</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>                        file.Close();</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>                        <span class="keyword">using</span> (var outputFile = <span class="keyword">new</span> FileStream(FilePath, FileMode.Create, FileAccess.Write))</div>
<div class="line"><span class="lineno">  255</span>                        {</div>
<div class="line"><span class="lineno">  256</span>                            workbook.Write(outputFile);</div>
<div class="line"><span class="lineno">  257</span>                            outputFile.Close();</div>
<div class="line"><span class="lineno">  258</span>                        }</div>
<div class="line"><span class="lineno">  259</span>                    }</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span> </div>
<div class="line"><span class="lineno">  262</span>                }</div>
<div class="line"><span class="lineno">  263</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FilePath.IndexOf(<span class="stringliteral">&quot;.xls&quot;</span>) &gt; 0)</div>
<div class="line"><span class="lineno">  264</span>                {</div>
<div class="line"><span class="lineno">  265</span>                    <span class="keyword">using</span> (var file = <span class="keyword">new</span> FileStream(FilePath, FileMode.Open, FileAccess.Read))</div>
<div class="line"><span class="lineno">  266</span>                    {</div>
<div class="line"><span class="lineno">  267</span>                        HSSFWorkbook workbook = <span class="keyword">new</span> HSSFWorkbook(file);</div>
<div class="line"><span class="lineno">  268</span>                        ISheet sheet = workbook.GetSheet(sheetName);</div>
<div class="line"><span class="lineno">  269</span>                        <span class="keywordflow">if</span>(row==0) { </div>
<div class="line"><span class="lineno">  270</span>                            return ; </div>
<div class="line"><span class="lineno">  271</span>                        }</div>
<div class="line"><span class="lineno">  272</span>                        IRow excelRow = sheet.GetRow(row);</div>
<div class="line"><span class="lineno">  273</span>                        <span class="keywordflow">if</span> (excelRow == <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  274</span>                        {</div>
<div class="line"><span class="lineno">  275</span>                            excelRow = sheet.CreateRow(row);</div>
<div class="line"><span class="lineno">  276</span>                        }</div>
<div class="line"><span class="lineno">  277</span>                        ICell cell = excelRow.GetCell(column) ?? excelRow.CreateCell(column);</div>
<div class="line"><span class="lineno">  278</span>                        <span class="keywordflow">if</span> (content.Equals(<span class="stringliteral">&quot;1&quot;</span>))</div>
<div class="line"><span class="lineno">  279</span>                        {</div>
<div class="line"><span class="lineno">  280</span>                            cell.SetCellValue(1);</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>                        }</div>
<div class="line"><span class="lineno">  283</span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (content.Equals(<span class="stringliteral">&quot;0&quot;</span>))</div>
<div class="line"><span class="lineno">  284</span>                        {</div>
<div class="line"><span class="lineno">  285</span>                            cell.SetCellValue(0);</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>                        }</div>
<div class="line"><span class="lineno">  288</span>                        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  289</span>                        {</div>
<div class="line"><span class="lineno">  290</span>                            cell.SetCellValue(content);</div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>                        }</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>                        <span class="comment">//var formulaEvaluator = workbook.GetCreationHelper().CreateFormulaEvaluator();</span></div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  298</span>                        <span class="comment">//formulaEvaluator.EvaluateAll();</span></div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>                        file.Close();</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>                        <span class="keyword">using</span> (var outputFile = <span class="keyword">new</span> FileStream(FilePath, FileMode.Create, FileAccess.Write))</div>
<div class="line"><span class="lineno">  303</span>                        {</div>
<div class="line"><span class="lineno">  304</span>                            workbook.Write(outputFile);</div>
<div class="line"><span class="lineno">  305</span>                            outputFile.Close();</div>
<div class="line"><span class="lineno">  306</span>                        }</div>
<div class="line"><span class="lineno">  307</span>                    }</div>
<div class="line"><span class="lineno">  308</span>                }</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>            }</div>
<div class="line"><span class="lineno">  313</span>            <span class="keywordflow">catch</span> (IOException ex)</div>
<div class="line"><span class="lineno">  314</span>            {</div>
<div class="line"><span class="lineno">  315</span>                <span class="comment">// Handle file-related errors</span></div>
<div class="line"><span class="lineno">  316</span>                Console.WriteLine(<span class="stringliteral">&quot;Une erreur s&#39;est produite lors de la modification du fichier Excel: &quot;</span> + ex.Message);</div>
<div class="line"><span class="lineno">  317</span>            }</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a863dcac459cb2729890ee5c3af1fad78" name="a863dcac459cb2729890ee5c3af1fad78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a863dcac459cb2729890ee5c3af1fad78">&#9670;&#160;</a></span>UpdateExcelFormula()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ApplicationInventaire.Core.ExcelManagement.ExcelFile.UpdateExcelFormula </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Go through all excel file and update the cell according to their value. This is used because just changing the value with the function SetCellValue doesn't do anything. </p>

<p class="definition">Definition at line <a class="el" href="_excel_management_8cs_source.html#l00355">355</a> of file <a class="el" href="_excel_management_8cs_source.html">ExcelManagement.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  356</span>        {</div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>            <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno">  359</span>            {</div>
<div class="line"><span class="lineno">  360</span>                <span class="keywordflow">if</span> (FilePath.IndexOf(<span class="stringliteral">&quot;.xlsx&quot;</span>) &gt; 0)</div>
<div class="line"><span class="lineno">  361</span>                {</div>
<div class="line"><span class="lineno">  362</span>                    <span class="keyword">using</span> (var file = <span class="keyword">new</span> FileStream(FilePath, FileMode.Open, FileAccess.Read))</div>
<div class="line"><span class="lineno">  363</span>                    {</div>
<div class="line"><span class="lineno">  364</span>                        XSSFWorkbook workbook = <span class="keyword">new</span> XSSFWorkbook(file);</div>
<div class="line"><span class="lineno">  365</span>                        </div>
<div class="line"><span class="lineno">  366</span>                        var formulaEvaluator = workbook.GetCreationHelper().CreateFormulaEvaluator();</div>
<div class="line"><span class="lineno">  367</span> </div>
<div class="line"><span class="lineno">  368</span>                        <span class="comment">// Evaluate the formulas</span></div>
<div class="line"><span class="lineno">  369</span>                        <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno">  370</span>                        {</div>
<div class="line"><span class="lineno">  371</span>                            formulaEvaluator.EvaluateAll();</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>                        }</div>
<div class="line"><span class="lineno">  374</span>                        <span class="keywordflow">catch</span>(Exception ex) { }</div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span>                        file.Close();</div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span>                        <span class="keyword">using</span> (var outputFile = <span class="keyword">new</span> FileStream(FilePath, FileMode.Create, FileAccess.Write))</div>
<div class="line"><span class="lineno">  379</span>                        {</div>
<div class="line"><span class="lineno">  380</span>                            workbook.Write(outputFile);</div>
<div class="line"><span class="lineno">  381</span>                            outputFile.Close();</div>
<div class="line"><span class="lineno">  382</span>                        }</div>
<div class="line"><span class="lineno">  383</span>                    }</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span> </div>
<div class="line"><span class="lineno">  386</span>                }</div>
<div class="line"><span class="lineno">  387</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FilePath.IndexOf(<span class="stringliteral">&quot;.xls&quot;</span>) &gt; 0)</div>
<div class="line"><span class="lineno">  388</span>                {</div>
<div class="line"><span class="lineno">  389</span>                    <span class="keyword">using</span> (var file = <span class="keyword">new</span> FileStream(FilePath, FileMode.Open, FileAccess.Read))</div>
<div class="line"><span class="lineno">  390</span>                    {</div>
<div class="line"><span class="lineno">  391</span>                        HSSFWorkbook workbook = <span class="keyword">new</span> HSSFWorkbook(file);</div>
<div class="line"><span class="lineno">  392</span> </div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span>                        var formulaEvaluator = workbook.GetCreationHelper().CreateFormulaEvaluator();</div>
<div class="line"><span class="lineno">  395</span> </div>
<div class="line"><span class="lineno">  396</span>                        <span class="comment">// Evaluate the formulas</span></div>
<div class="line"><span class="lineno">  397</span>                        <span class="keywordflow">try</span> </div>
<div class="line"><span class="lineno">  398</span>                        {</div>
<div class="line"><span class="lineno">  399</span>                            formulaEvaluator.EvaluateAll();</div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>                        }</div>
<div class="line"><span class="lineno">  402</span>                        <span class="keywordflow">catch</span> (Exception ex) { }</div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>                        file.Close();</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>                        <span class="keyword">using</span> (var outputFile = <span class="keyword">new</span> FileStream(FilePath, FileMode.Create, FileAccess.Write))</div>
<div class="line"><span class="lineno">  407</span>                        {</div>
<div class="line"><span class="lineno">  408</span>                            workbook.Write(outputFile);</div>
<div class="line"><span class="lineno">  409</span>                            outputFile.Close();</div>
<div class="line"><span class="lineno">  410</span>                        }</div>
<div class="line"><span class="lineno">  411</span>                    }</div>
<div class="line"><span class="lineno">  412</span>                }</div>
<div class="line"><span class="lineno">  413</span> </div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span>            }</div>
<div class="line"><span class="lineno">  417</span>            <span class="keywordflow">catch</span> (IOException ex)</div>
<div class="line"><span class="lineno">  418</span>            {</div>
<div class="line"><span class="lineno">  419</span>                <span class="comment">// Handle file-related errors</span></div>
<div class="line"><span class="lineno">  420</span>                Console.WriteLine(<span class="stringliteral">&quot;Une erreur s&#39;est produite lors de la modification du fichier Excel: &quot;</span> + ex.Message);</div>
<div class="line"><span class="lineno">  421</span>            }</div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aace1a5a981ebc09c8e0721d9c5ba257c" name="aace1a5a981ebc09c8e0721d9c5ba257c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aace1a5a981ebc09c8e0721d9c5ba257c">&#9670;&#160;</a></span>UpdateSignature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ApplicationInventaire.Core.ExcelManagement.ExcelFile.UpdateSignature </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is called when the user click "enregistrer et quitter" in the inventory update. It will add the current date end the user name (name of the session) at the end of the document in the two colums "DATE de MISE A JOUR" and "NOM + SIGNATURE". </p>

<p class="definition">Definition at line <a class="el" href="_excel_management_8cs_source.html#l00326">326</a> of file <a class="el" href="_excel_management_8cs_source.html">ExcelManagement.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  327</span>        {</div>
<div class="line"><span class="lineno">  328</span>            <span class="keywordtype">string</span> user = Environment.UserName;</div>
<div class="line"><span class="lineno">  329</span>            System.DateTime date = DateTime.Now;</div>
<div class="line"><span class="lineno">  330</span>            <span class="keywordtype">string</span> dateStr=date.Day.ToString()+<span class="stringliteral">&quot;/&quot;</span>+date.Month.ToString()+<span class="stringliteral">&quot;/&quot;</span>+date.Year.ToString();</div>
<div class="line"><span class="lineno">  331</span>            <a class="code hl_class" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_cell_info.html">CellInfo</a> SignatureCell = <a class="code hl_function" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file.html#ae08e9d32876e7f3fadf0768888efdb3b">FindValue</a>(<span class="stringliteral">&quot;NOM + SIGNATURE&quot;</span>);</div>
<div class="line"><span class="lineno">  332</span>            <a class="code hl_class" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_cell_info.html">CellInfo</a> DateCell = <a class="code hl_function" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file.html#ae08e9d32876e7f3fadf0768888efdb3b">FindValue</a>(<span class="stringliteral">&quot;DATE de MISE A JOUR&quot;</span>);</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>            <span class="keywordtype">int</span> i = SignatureCell.Row;</div>
<div class="line"><span class="lineno">  335</span>            <span class="keywordflow">while</span>(!<a class="code hl_function" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file.html#a24e4069458ce7ca2d5cf6ca16b7aded3">GetCellValue</a>(SignatureCell.Sheet,i,SignatureCell.Column).Equals(<span class="stringliteral">&quot;&quot;</span>))</div>
<div class="line"><span class="lineno">  336</span>            {</div>
<div class="line"><span class="lineno">  337</span>                i++;</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>            }</div>
<div class="line"><span class="lineno">  340</span>            this.<a class="code hl_function" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file.html#a35362ac6effb32a3e6f2038325945464">SetCellValue</a>(SignatureCell.Sheet, user, SignatureCell.Column,i) ;</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>            i = SignatureCell.Row;</div>
<div class="line"><span class="lineno">  343</span>            <span class="keywordflow">while</span> (!<a class="code hl_function" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file.html#a24e4069458ce7ca2d5cf6ca16b7aded3">GetCellValue</a>(DateCell.Sheet, i, DateCell.Column).Equals(<span class="stringliteral">&quot;&quot;</span>))</div>
<div class="line"><span class="lineno">  344</span>            {</div>
<div class="line"><span class="lineno">  345</span>                i++;</div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  347</span>            }</div>
<div class="line"><span class="lineno">  348</span>            this.<a class="code hl_function" href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file.html#a35362ac6effb32a3e6f2038325945464">SetCellValue</a>(DateCell.Sheet, dateStr, DateCell.Column, i);</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span>        }</div>
<div class="ttc" id="aclass_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file_html_a24e4069458ce7ca2d5cf6ca16b7aded3"><div class="ttname"><a href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file.html#a24e4069458ce7ca2d5cf6ca16b7aded3">ApplicationInventaire.Core.ExcelManagement.ExcelFile.GetCellValue</a></div><div class="ttdeci">string GetCellValue(string sheetName, int row, int column)</div><div class="ttdoc">Used to return the string contained in the cell in a given row column and sheet.</div><div class="ttdef"><b>Definition</b> <a href="_excel_management_8cs_source.html#l00080">ExcelManagement.cs:80</a></div></div>
<div class="ttc" id="aclass_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file_html_a35362ac6effb32a3e6f2038325945464"><div class="ttname"><a href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file.html#a35362ac6effb32a3e6f2038325945464">ApplicationInventaire.Core.ExcelManagement.ExcelFile.SetCellValue</a></div><div class="ttdeci">void SetCellValue(string sheetName, string content, int column, int row)</div><div class="ttdoc">set the cell in a given row column and sheet to a given string</div><div class="ttdef"><b>Definition</b> <a href="_excel_management_8cs_source.html#l00214">ExcelManagement.cs:214</a></div></div>
<div class="ttc" id="aclass_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file_html_ae08e9d32876e7f3fadf0768888efdb3b"><div class="ttname"><a href="class_application_inventaire_1_1_core_1_1_excel_management_1_1_excel_file.html#ae08e9d32876e7f3fadf0768888efdb3b">ApplicationInventaire.Core.ExcelManagement.ExcelFile.FindValue</a></div><div class="ttdeci">CellInfo FindValue(string content)</div><div class="ttdoc">find the first cell in a given file (.xls or .xlsx) containing a given string</div><div class="ttdef"><b>Definition</b> <a href="_excel_management_8cs_source.html#l00434">ExcelManagement.cs:434</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Property Documentation</h2>
<a id="a7a503282c1e70c3c0c830735eb878d93" name="a7a503282c1e70c3c0c830735eb878d93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a503282c1e70c3c0c830735eb878d93">&#9670;&#160;</a></span>FilePath</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">string ApplicationInventaire.Core.ExcelManagement.ExcelFile.FilePath</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span><span class="mlabel">set</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_excel_management_8cs_source.html#l00062">62</a> of file <a class="el" href="_excel_management_8cs_source.html">ExcelManagement.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   62</span>{ <span class="keyword">get</span>; <span class="keyword">set</span>; }</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>C:/Users/regnaulte/Documents/VSPROJECTS/VisualStudio/ApplicationInventaire/Core/<a class="el" href="_excel_management_8cs_source.html">ExcelManagement.cs</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
